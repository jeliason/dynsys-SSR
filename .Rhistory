degree=4
x0=1
ics=10
tf=8
times=seq(0,tf,by=step)
df<-lapply(ics, function(z) simple1dsolve(x0=z,step=step,tf=tf,sd=sd,degree=degree))
df<-do.call("rbind",df)
fit<-bas.lm(y1~.,data=df)
summary(fit)
set.seed(134)
step=.01
sd=0.1
degree=4
x0=1
ics=10
tf=8
times=seq(0,tf,by=step)
df<-lapply(ics, function(z) simple1dsolve(x0=z,step=step,tf=tf,sd=sd,degree=degree))
df<-do.call("rbind",df)
fit<-bas.lm(y1~.,data=df)
summary(fit)
set.seed(123)
step=.01
sd=0.1
degree=4
x0=1
ics=10
tf=16
times=seq(0,tf,by=step)
df<-lapply(ics, function(z) simple1dsolve(x0=z,step=step,tf=tf,sd=sd,degree=degree))
df<-do.call("rbind",df)
fit<-bas.lm(y1~.,data=df)
summary(fit)
set.seed(123)
step=.01
sd=0.1
degree=4
x0=1
ics=10
tf=16
times=seq(0,tf,by=step)
df<-lapply(ics, function(z) simple1dsolve(x0=z,step=step,tf=tf,sd=sd,degree=degree))
df<-do.call("rbind",df)
fit<-bas.lm(y1~.,data=df)
summary(fit)
set.seed(123)
step=.01
sd=0.1
degree=4
x0=1
ics=10
tf=16
times=seq(0,tf,by=step)
df<-lapply(ics, function(z) simple1dsolve(x0=z,step=step,tf=tf,sd=sd,degree=degree))
df<-do.call("rbind",df)
fit<-bas.lm(y1~.,data=df)
summary(fit)
step=.01
sd=0.1
degree=4
x0=1
ics=10
tf=8
times=seq(0,tf,by=step)
df<-lapply(ics, function(z) simple1dsolve(x0=z,step=step,tf=tf,sd=sd,degree=degree))
df<-do.call("rbind",df)
fit<-bas.lm(y1~.,data=df)
summary(fit)
step=.01
sd=0.1
degree=4
x0=1
ics=10
tf=8
times=seq(0,tf,by=step)
df<-lapply(ics, function(z) simple1dsolve(x0=z,step=step,tf=tf,sd=sd,degree=degree))
df<-do.call("rbind",df)
fit<-bas.lm(y1~.,data=df)
summary(fit)
step=.01
sd=0.1
degree=4
x0=1
ics=10
tf=8
times=seq(0,tf,by=step)
df<-lapply(ics, function(z) simple1dsolve(x0=z,step=step,tf=tf,sd=sd,degree=degree))
df<-do.call("rbind",df)
fit<-bas.lm(y1~.,data=df)
summary(fit)
step=.01
sd=0.1
degree=4
x0=1
ics=10
tf=8
times=seq(0,tf,by=step)
df<-lapply(ics, function(z) simple1dsolve(x0=z,step=step,tf=tf,sd=sd,degree=degree))
df<-do.call("rbind",df)
fit<-bas.lm(y1~.,data=df)
summary(fit)
step=.01
sd=0.1
degree=4
x0=1
ics=10
tf=8
times=seq(0,tf,by=step)
df<-lapply(ics, function(z) simple1dsolve(x0=z,step=step,tf=tf,sd=sd,degree=degree))
df<-do.call("rbind",df)
fit<-bas.lm(y1~.,data=df)
summary(fit)
step=.01
sd=0.1
degree=4
x0=1
ics=10
tf=8
times=seq(0,tf,by=step)
df<-lapply(ics, function(z) simple1dsolve(x0=z,step=step,tf=tf,sd=sd,degree=degree))
df<-do.call("rbind",df)
fit<-bas.lm(y1~.,data=df)
summary(fit)
step=.01
sd=0.1
degree=4
x0=1
ics=10
tf=8
times=seq(0,tf,by=step)
df<-lapply(ics, function(z) simple1dsolve(x0=z,step=step,tf=tf,sd=sd,degree=degree))
df<-do.call("rbind",df)
fit<-bas.lm(y1~.,data=df)
summary(fit)
step=.01
sd=0.1
degree=4
x0=1
ics=10
tf=8
times=seq(0,tf,by=step)
df<-lapply(ics, function(z) simple1dsolve(x0=z,step=step,tf=tf,sd=sd,degree=degree))
df<-do.call("rbind",df)
fit<-bas.lm(y1~.,data=df)
summary(fit)
step=.01
sd=0.1
degree=4
x0=1
ics=10
tf=8
times=seq(0,tf,by=step)
df<-lapply(ics, function(z) simple1dsolve(x0=z,step=step,tf=tf,sd=sd,degree=degree))
df<-do.call("rbind",df)
fit<-bas.lm(y1~.,data=df)
summary(fit)
step=.01
sd=0.1
degree=4
x0=1
ics=10
tf=8
times=seq(0,tf,by=step)
df<-lapply(ics, function(z) simple1dsolve(x0=z,step=step,tf=tf,sd=sd,degree=degree))
df<-do.call("rbind",df)
fit<-bas.lm(y1~.,data=df)
summary(fit)
step=.01
sd=0.1
degree=4
x0=1
ics=10
tf=8
times=seq(0,tf,by=step)
df<-lapply(ics, function(z) simple1dsolve(x0=z,step=step,tf=tf,sd=sd,degree=degree))
df<-do.call("rbind",df)
fit<-bas.lm(y1~.,data=df)
summary(fit)
step=.01
sd=0.1
degree=4
x0=1
ics=10
tf=8
times=seq(0,tf,by=step)
df<-lapply(ics, function(z) simple1dsolve(x0=z,step=step,tf=tf,sd=sd,degree=degree))
df<-do.call("rbind",df)
fit<-bas.lm(y1~.,data=df)
summary(fit)
step=.01
sd=0.1
degree=4
x0=1
ics=10
tf=8
times=seq(0,tf,by=step)
df<-lapply(ics, function(z) simple1dsolve(x0=z,step=step,tf=tf,sd=sd,degree=degree))
df<-do.call("rbind",df)
fit<-bas.lm(y1~.,data=df)
summary(fit)
step=.01
sd=0.1
degree=4
x0=1
ics=10
tf=8
times=seq(0,tf,by=step)
df<-lapply(ics, function(z) simple1dsolve(x0=z,step=step,tf=tf,sd=sd,degree=degree))
df<-do.call("rbind",df)
fit<-bas.lm(y1~.,data=df)
summary(fit)
step=.01
sd=0.1
degree=4
x0=1
ics=10
tf=8
times=seq(0,tf,by=step)
df<-lapply(ics, function(z) simple1dsolve(x0=z,step=step,tf=tf,sd=sd,degree=degree))
df<-do.call("rbind",df)
fit<-bas.lm(y1~.,data=df)
summary(fit)
step=.01
sd=0.1
degree=4
x0=1
ics=10
tf=0.5
times=seq(0,tf,by=step)
df<-lapply(ics, function(z) simple1dsolve(x0=z,step=step,tf=tf,sd=sd,degree=degree))
df<-do.call("rbind",df)
fit<-bas.lm(y1~.,data=df)
summary(fit)
fit$postprobs
fit$postprobs.RN
fit$postprobs
fit
summary(fit)
fit$which
fit$model
fit$terms
fit$df
fit$logmarg
fit$size
f<-summary(fit)
f
}
f
f[5,3]
f[8,3]
f[8,5]
length(f)
f$postprobs
set.seed(123)
step=.01
sd=0.1
degree=4
x0=1
ics=10
tf=16
times=seq(0,tf,by=step)
df<-lapply(ics, function(z) simple1dsolve(x0=z,step=step,tf=tf,sd=sd,degree=degree))
df<-do.call("rbind",df)
fit<-bas.lm(y1~.,data=df)
summary(fit)
fit$postprobs
fit$which
w<-fit$which
w[16]
match(c(0,1,3,4),w)
?match
w[1]
?Position
?match
?identical
sapply(w,function(z) identical(z,c(0,1,3,4)))
sapply(w,function(z) identical(z,list(0,1,3,4)))
list(0,1,3,4)
w[16]
w[[16]]
w[[16]][1]
w[[16]]
c(0,1,3,4)
list(c(0,1,3,4))
sapply(w,function(z) identical(z,list(c(0,1,3,4))))
list(c(0,1,3,4))
w
identical(list(c(0,1,3,4)),w[16])
identical(list(c(0,1,3,4)),w[[16]])
identical(c(0,1,3,4),w[[16]])
w[[16]]
c(0,1,3,4)
list(c(0,1,3,4))==w[16]
all(list(c(0,1,3,4))==w[16])
type(w[16])
typeof(w[16])
typeof(list(c(0,1,3,4)))
sapply(w,function(z) identical(unlist(z),c(0,1,3,4)))
identical(unlist(w[16],c(0,1,3,4)))
identical(unlist(w[16]),c(0,1,3,4)))
identical(unlist(w[16]),c(0,1,3,4))
unlist(w[16])
c(0,1,3,4)
list1=list(c(0,1,3,4))
list1
identical(w[16],list1)
w[16]
list(w[16])
unlist(w[16])
unlist(w[16])
all(unlist(w[16])==c(0,1,3,4))
sapply(w,function(z) all(unlist(z)==c(0,1,3,4)))
?all
fit$postprobs[16]
knitr::opts_chunk$set(echo = TRUE)
?hist
?seq
knitr::opts_chunk$set(echo = TRUE,fig.width=12, fig.height=6)
library(deSolve)
library(BMS)
library(BAS)
library(gridExtra)
library(grid)
library(ggplot2)
source("simple1dsolve.R")
source("cubic2dsolve.R")
source("plot_cubic.R")
source("bms_summary.R")
# set.seed(123)
step=.01
sd=0.1
degree=4
ics=seq(0.0001,12,length.out=10)
tf=3
times=seq(0,tf,by=step)
numSeeds=200
post_probs<-rep(0,numSeeds)
df_postprobs<-data.frame()
for(j in ics){
for (i in 1:numSeeds){
set.seed(i)
df<-simple1dsolve(x0=j,step=step,tf=tf,sd=sd,degree=degree)
fit<-bas.lm(y1~.,data=df)
w<-fit$which
lv=sapply(w,function(z) all(unlist(z)==c(0,1,3,4)))
idx=min(which(lv == TRUE))
post_probs[i]=fit$postprobs[idx]
}
df_postprobs$as.name(ics[j])<-post_probs
}
ics
ics[1]
ics[2]
as.name(ics[2])
df_postprobs
df_postprobs$ic1<-post_probs
step=.01
sd=0.1
degree=4
ics=seq(0.0001,12,length.out=10)
tf=3
times=seq(0,tf,by=step)
numSeeds=200
post_probs<-rep(0,numSeeds)
df_postprobs<-data.frame(nrow=100)
for(j in ics){
for (i in 1:numSeeds){
set.seed(i)
df<-simple1dsolve(x0=j,step=step,tf=tf,sd=sd,degree=degree)
fit<-bas.lm(y1~.,data=df)
w<-fit$which
lv=sapply(w,function(z) all(unlist(z)==c(0,1,3,4)))
idx=min(which(lv == TRUE))
post_probs[i]=fit$postprobs[idx]
}
df_postprobs$as.name(ics[j])<-post_probs
}
df_postprobs$ic1<-post_probs
post_probs
step=.01
sd=0.1
degree=4
ics=seq(0.0001,12,length.out=10)
tf=3
times=seq(0,tf,by=step)
numSeeds=200
post_probs<-rep(0,numSeeds)
df_postprobs<-data.frame(matrix(nrow=numSeeds,ncol=10))
for(j in ics){
for (i in 1:numSeeds){
set.seed(i)
df<-simple1dsolve(x0=j,step=step,tf=tf,sd=sd,degree=degree)
fit<-bas.lm(y1~.,data=df)
w<-fit$which
lv=sapply(w,function(z) all(unlist(z)==c(0,1,3,4)))
idx=min(which(lv == TRUE))
post_probs[i]=fit$postprobs[idx]
}
df_postprobs$as.name(ics[j])<-post_probs
}
df_postprobs$ic1<-post_probs
View(df_postprobs)
step=.01
sd=0.1
degree=4
ics=seq(0.0001,12,length.out=10)
tf=3
times=seq(0,tf,by=step)
numSeeds=200
post_probs<-rep(0,numSeeds)
df_postprobs<-data.frame(matrix(nrow=numSeeds,ncol=1))
for(j in ics){
for (i in 1:numSeeds){
set.seed(i)
df<-simple1dsolve(x0=j,step=step,tf=tf,sd=sd,degree=degree)
fit<-bas.lm(y1~.,data=df)
w<-fit$which
lv=sapply(w,function(z) all(unlist(z)==c(0,1,3,4)))
idx=min(which(lv == TRUE))
post_probs[i]=fit$postprobs[idx]
}
df_postprobs$as.name(ics[j])<-post_probs
}
step=.01
sd=0.1
degree=4
ics=seq(0.0001,12,length.out=10)
tf=3
times=seq(0,tf,by=step)
numSeeds=200
post_probs<-rep(0,numSeeds)
df_postprobs<-data.frame(matrix(nrow=numSeeds,ncol=1))
for(j in ics){
for (i in 1:numSeeds){
set.seed(i)
df<-simple1dsolve(x0=j,step=step,tf=tf,sd=sd,degree=degree)
fit<-bas.lm(y1~.,data=df)
w<-fit$which
lv=sapply(w,function(z) all(unlist(z)==c(0,1,3,4)))
idx=min(which(lv == TRUE))
post_probs[i]=fit$postprobs[idx]
}
df_postprobs$ics[j]<-post_probs
}
step=.01
sd=0.1
degree=4
ics=seq(0.0001,12,length.out=10)
tf=3
times=seq(0,tf,by=step)
numSeeds=200
df_postprobs<-data.frame(matrix(nrow=numSeeds,ncol=1))
for(j in ics){
for (i in 1:numSeeds){
set.seed(i)
post_probs<-rep(0,numSeeds)
df<-simple1dsolve(x0=j,step=step,tf=tf,sd=sd,degree=degree)
fit<-bas.lm(y1~.,data=df)
w<-fit$which
lv=sapply(w,function(z) all(unlist(z)==c(0,1,3,4)))
idx=min(which(lv == TRUE))
post_probs[i]=fit$postprobs[idx]
}
df_postprobs$ics[j]<-post_probs
}
step=.01
sd=0.1
degree=4
ics=seq(0.0001,12,length.out=10)
tf=3
times=seq(0,tf,by=step)
numSeeds=200
df_postprobs<-data.frame(matrix(nrow=numSeeds,ncol=1))
for(j in ics){
for (i in 1:numSeeds){
set.seed(i)
post_probs<-rep(0,numSeeds)
df<-simple1dsolve(x0=j,step=step,tf=tf,sd=sd,degree=degree)
fit<-bas.lm(y1~.,data=df)
w<-fit$which
lv=sapply(w,function(z) all(unlist(z)==c(0,1,3,4)))
idx=min(which(lv == TRUE))
post_probs[i]=fit$postprobs[idx]
}
df_postprobs=cbind(df_postprobs,post_probs)
}
# hist(post_probs,breaks=40)
# median(post_probs)
meds<-apply(df_postprobs,2,median)
meds
df_postprobs
df_postprobs
g<-c(1,2,3)
f<-c(4,5,6)
polym(g,f,degree=3,raw=TRUE)
knitr::opts_chunk$set(echo = TRUE,fig.width=12, fig.height=6)
library(deSolve)
library(BMS)
library(BAS)
library(gridExtra)
library(grid)
library(ggplot2)
source("simple1dsolve.R")
source("cubic2dsolve.R")
source("plot_cubic.R")
source("bms_summary.R")
# set.seed(123)
df<-cubic2dsolve(x0=ics,step=step,tf=tf,sd=sd,degree=degree)
ics=c(1,1)
degree=3
df<-cubic2dsolve(x0=ics,step=step,tf=tf,sd=sd,degree=degree)
View(df)
